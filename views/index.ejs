<%- include('partials/header', { title: 'Trang chủ', user: loggedInUser }) %>
<%- include('partials/navbar', { user: loggedInUser }) %>

<div class="home-container">
  <h1 class="page-title">Bộ sưu tập Nước hoa</h1>

  <!-- FORM TÌM KIẾM -->
  <div class="search-box">
    <form action="/" method="GET" class="search-form">
      <input
        type="text"
        name="search"
        placeholder="Tìm kiếm theo tên nước hoa..."
        value="<%= search || '' %>"
      />
      <select name="brandId">
        <option value="">Lọc theo Thương hiệu</option>
        <% brands.forEach(brand => { %>
          <option
            value="<%= brand._id %>"
            <%= brandId === brand._id.toString() ? 'selected' : '' %>
          >
            <%= brand.brandName %>
          </option>
        <% }) %>
      </select>
      <button type="submit">Tìm kiếm</button>
    </form>
  </div>

  <!-- GRID HIỂN THỊ NƯỚC HOA -->
  <div class="perfume-grid">
    <% perfumes.forEach(perfume => { %>
      <div class="perfume-card">
        <div class="image-wrapper">
          <img src="<%= perfume.uri %>" alt="<%= perfume.perfumeName %>" />
        </div>

        <div class="card-content">
          <h2>
            <%= perfume.perfumeName %>
            <% if (perfume.concentration === 'Extrait') { %>
              <span class="badge">EXTRAIT ⭐</span>
            <% } %>
          </h2>

          <p>
            Thương hiệu:
            <strong><%= perfume.brand.brandName %></strong> | Dành cho:
            <%= perfume.targetAudience %>
          </p>

          <a href="/perfumes/<%= perfume._id %>" class="btn-detail">
            Xem Chi tiết
          </a>
        </div>
      </div>
    <% }) %>

    <% if (perfumes.length === 0) { %>
      <div class="no-result">Không tìm thấy sản phẩm nào.</div>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>
