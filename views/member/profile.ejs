<%- include('../partials/header', { title: 'Cập nhật Hồ sơ', user: loggedInUser, pageCss: 'profile.css' }) %>
<%- include('../partials/navbar', { user: loggedInUser }) %>

<main class="profile-container">
  <h1>Chỉnh sửa Hồ sơ cá nhân</h1>

  <% if (message) { %>
    <div class="alert <%= message.type === 'success' ? 'alert-success' : 'alert-error' %>">
      <%= message.text %>
    </div>
  <% } %>

  <section class="card">
    <h2>Thông tin Cơ bản</h2>

    <form action="/member/profile/<%= member._id %>?_method=PUT" method="POST">
      <div class="form-group">
        <label>Email</label>
        <input type="email" value="<%= member.email %>" disabled />
      </div>

      <div class="form-group">
        <label>Tên (name)</label>
        <input type="text" name="name" value="<%= member.name || '' %>" required />
      </div>

      <div class="form-group">
        <label>Năm sinh (YOB)</label>
        <input
          type="number"
          name="YOB"
          value="<%= member.YOB || '' %>"
          min="1900"
          max="<%= new Date().getFullYear() %>"
        />
      </div>

      <div class="form-group">
        <label>Giới tính (gender)</label>
        <select name="gender">
          <option value="true" <%= member.gender === true ? 'selected' : '' %>>Nam</option>
          <option value="false" <%= member.gender === false ? 'selected' : '' %>>Nữ</option>
          <option value="" <%= member.gender == null ? 'selected' : '' %>>Chưa xác định</option>
        </select>
      </div>

      <button type="submit" class="btn-primary">Lưu Thay đổi Profile</button>
    </form>
  </section>

  <section class="card">
    <h2 class="text-error">Đổi Mật khẩu</h2>
    <p class="note">Chỉ điền vào các trường này nếu bạn muốn đổi mật khẩu.</p>

    <form action="/member/password?_method=PUT" method="POST">
      <div class="form-group">
        <label>Mật khẩu mới</label>
        <input type="password" name="newPassword" required />
      </div>

      <div class="form-group">
        <label>Xác nhận Mật khẩu mới</label>
        <input type="password" name="confirmNewPassword" required />
      </div>

      <button type="submit" class="btn-error">Đổi Mật khẩu</button>
    </form>
  </section>

  <p class="warning">
    Lưu ý: Bạn không được phép chỉnh sửa hoặc xóa thông tin của thành viên khác, kể cả Admin.
  </p>
</main>

<%- include('../partials/footer') %>
